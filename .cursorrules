# CURSOR RULES - Heroes of Time Project

## 🚨 RÈGLES CRITIQUES APPRISES AUJOURD'HUI

### Git - Commandes INTERDITES sur Agent Partagé
- ❌ **JAMAIS** `git reset --hard` - Agent partagé, plusieurs développeurs
- ❌ **JAMAIS** `git push --force` - Destructif pour l'équipe  
- ❌ **JAMAIS** suppression de branches sans concertation
- ✅ **UTILISER** : `git checkout <commit> -- <fichier>` pour restaurer
- ✅ **UTILISER** : `git revert` pour annuler des commits
- ✅ **UTILISER** : `git stash` pour sauvegarder

### Interface Temporelle - Versions Fonctionnelles
- ✅ **Interface Légendaire** : `frontend-legendary-ui/` (port 5190)
  - Commit source : 08353dc99341a197203656dc37140b8afba73b01
  - Features : Animated heroes + Particles + Smooth movement
  - Serveur : `python3 server.py` avec CORS
- ✅ **Interface Temporelle** : `frontend-temporal/` (port 5174)  
  - Commit sauvegardé : 5ef2203
  - Features : Épée temporelle animée + Configuration Temporelle

### Backend - Problèmes Connus
- 🔴 **Erreur JPA** : "Not a managed type: class Game"
- 🔴 **ComplexAmplitude** : Existe mais problème de dépendances Maven
- 🔴 **DynamicFormulaParser** : Méthode `executeFormula` manquante
- ✅ **Correction** : Utiliser `executeFormulaEffect(formula, hero, game, 0)`

### Commandes - Bonnes Pratiques
- ✅ **Frontend** : `cd frontend-temporal && python3 -m http.server 5174`
- ✅ **Backend** : `cd backend && mvn spring-boot:run`
- ✅ **UI Légendaire** : `cd frontend-legendary-ui && python3 server.py`
- ✅ **Ports libres** : `pkill -f "http.server"` avant relancement

### Récupération Sécurisée
- ✅ **Fichiers spécifiques** : `git checkout <commit> -- <path>` 
- ✅ **Vérifier avant** : `git show <commit> --name-only`
- ❌ **Éviter** : Récupération complète qui écrase tout

### Cache Cursor - Problèmes Connus  
- 🔴 **Problème** : `git checkout` et `git reset` corrompus par cache
- ✅ **Solution** : Extraction manuelle avec `git show <commit>:<file>`
- ✅ **Alternative** : Utiliser les checkpoints Cursor pour restaurer

## 📝 NOTES IMPORTANTES

### Visualiseur JSON - À Préserver
- 🛡️ **Ne PAS écraser** les corrections du visualiseur JSON
- 🛡️ **Récupération sélective** uniquement pour UI

### Serveurs Multiples - Gestion Ports DÉFINITIVE
- Port 9000 : Dashboard Unifié (`dashboard.html`) - **PRINCIPAL**
- Port 8000 : Frontend Principal (`frontend/`) - Console temporelle + carte hex
- Port 8080 : Backend Spring Boot API (`backend/`) - **APIs REST**
- Port 5174 : Interface Temporelle (`frontend-temporal/`) - Configuration Temporelle
- Port 8001 : Quantum Visualizer (`quantum-visualizer/`) - Scénarios GROFI
- Port 5175 : Object Viewer (`visualizer-server.py`) - JSON/HOTS/Dashboard
- Port 5170 : JSON Visualizer (DÉPRÉCIÉ - remplacé par 5175)
- Port 5171 : HOTS Visualizer (DÉPRÉCIÉ - remplacé par 5175)
- Port 5190 : Interface Légendaire (`frontend-legendary-ui/`) - **OPTIONNEL**
- Port 8888 : Test Runner - **RÉCUPÉRÉ de 872e0d7**

### 📋 COMMANDES STANDARDISÉES - OBLIGATOIRES
- ✅ **START ALL** : `./scripts/actifs/start-services-background.sh` - **PRINCIPAL**
- ✅ **STOP ALL** : `./scripts/actifs/stop-all-services.sh`
- ✅ **STATUS** : `lsof -i :9000,8000,8080,5174,8001,5175,8888 | grep LISTEN`
- ✅ **BACKEND START** : `cd backend && mvn spring-boot:run > /dev/null 2>&1 &`
- ✅ **QUICK TEST** : `./scripts/actifs/test-ui-quick.sh`
- ❌ **INTERDICTION** : Recréer des scripts ou commandes manuelles
- ❌ **INTERDICTION** : Changer les ports définis ci-dessus
- 🎯 **RÈGLE** : TOUJOURS utiliser les scripts existants dans `/scripts/actifs/`
- 🚨 **PORTS FIXES** : Ne JAMAIS changer les ports sans concertation

### 🚨 RÈGLE CRITIQUE : SERVICES EN ARRIÈRE-PLAN PERMANENT
- ❌ **JAMAIS** tuer les serveurs pendant le codage
- ❌ **JAMAIS** arrêter les UIs quand l'utilisateur teste
- ✅ **TOUJOURS** lancer avec `> /dev/null 2>&1 &` pour background permanent
- ✅ **LAISSER** les services actifs pour que l'utilisateur puisse tester
- ✅ **MAINTENIR** dashboard, JSON visualizer, HOTS visualizer actifs
- ✅ **COMMANDE TYPE** : `python3 -m http.server PORT > /dev/null 2>&1 &`
- 🎯 **OBJECTIF** : L'utilisateur peut tester et jouer pendant que l'agent code

### 🎮 SERVICES ACTUELLEMENT ACTIFS (PERMANENT BACKGROUND)
- ✅ Dashboard (9000) : http://localhost:9000/dashboard.html
- ✅ Frontend (8000) : http://localhost:8000
- ✅ Backend API (8080) : http://localhost:8080/api/games
- ✅ Temporal UI (5174) : http://localhost:5174
- ✅ Quantum Visualizer (8001) : http://localhost:8001
- ✅ Object Viewer (5175) : http://localhost:5175
- 🔧 Test Runner (8888) : À récupérer si nécessaire
- 🔧 UI Légendaire (5190) : Optionnelle

### Commit Messages - Format Appris
- ✅ **Bon format** : "🎯 MISSION UI LÉGENDAIRE ACCOMPLIE - Description détaillée"
- ✅ **Inclure** : Features, ports, sources git
- ✅ **Structurer** : Émojis + titre + détails techniques 