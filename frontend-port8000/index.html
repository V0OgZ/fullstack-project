<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåÄ Heroes of Time - Interface Temporelle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #e94560;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .header {
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem;
            text-align: center;
            border-bottom: 2px solid #e94560;
        }

        .header h1 {
            font-size: 2.5rem;
            text-shadow: 0 0 20px #e94560;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: #a0a0a0;
            font-size: 1.1rem;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .main-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(233, 69, 96, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .control-panel:hover {
            transform: translateY(-5px);
            border-color: #e94560;
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.3);
        }

        .control-panel h3 {
            color: #e94560;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .btn {
            background: linear-gradient(45deg, #e94560, #f27121);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            margin: 0.5rem;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.5);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn.secondary {
            background: linear-gradient(45deg, #16213e, #0f3460);
            border: 2px solid #e94560;
        }

        .status-display {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
            border-left: 4px solid #e94560;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .status-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .status-value {
            font-size: 2rem;
            font-weight: bold;
            color: #e94560;
            display: block;
        }

        .status-label {
            color: #a0a0a0;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .game-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            min-height: 400px;
            border: 1px solid rgba(233, 69, 96, 0.3);
        }

        .log-area {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 1rem;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border: 1px solid #e94560;
        }

        .log-entry {
            margin: 0.5rem 0;
            padding: 0.5rem;
            border-left: 3px solid #e94560;
            padding-left: 1rem;
        }

        .log-entry.success {
            border-left-color: #4CAF50;
            color: #4CAF50;
        }

        .log-entry.error {
            border-left-color: #f44336;
            color: #f44336;
        }

        .log-entry.info {
            border-left-color: #2196F3;
            color: #2196F3;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            color: #a0a0a0;
            border-top: 1px solid rgba(233, 69, 96, 0.3);
            margin-top: 3rem;
        }

        .api-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid #e94560;
            min-width: 200px;
        }

        .api-indicator {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }

        .api-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .api-dot.online {
            background: #4CAF50;
            box-shadow: 0 0 10px #4CAF50;
        }

        .api-dot.offline {
            background: #f44336;
            box-shadow: 0 0 10px #f44336;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(233, 69, 96, 0.3);
            border-radius: 50%;
            border-top-color: #e94560;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .input-group {
            margin: 1rem 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #e94560;
            font-weight: bold;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 0.8rem;
            border-radius: 8px;
            border: 1px solid rgba(233, 69, 96, 0.5);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #e94560;
            box-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåÄ Heroes of Time</h1>
        <p>Interface Temporelle Engine - Port 8000</p>
    </div>

    <!-- API Status -->
    <div class="api-status" id="apiStatus">
        <div class="api-indicator">
            <div class="api-dot offline" id="backendDot"></div>
            <span>Backend: <span id="backendStatus">Checking...</span></span>
        </div>
        <div class="api-indicator">
            <div class="api-dot offline" id="causalDot"></div>
            <span>Causal: <span id="causalStatus">Offline</span></span>
        </div>
    </div>

    <div class="container">
        <!-- Main Controls -->
        <div class="main-controls">
            <div class="control-panel">
                <h3>üéÆ Contr√¥les de Jeu</h3>
                <button class="btn" onclick="newGame()">üéÆ New Game</button>
                <button class="btn secondary" onclick="loadGame()">üìÇ Load Game</button>
                <button class="btn secondary" onclick="saveGame()">üíæ Save Game</button>
            </div>

            <div class="control-panel">
                <h3>üèõÔ∏è Gestion Ville</h3>
                <button class="btn" onclick="openTown()">üèõÔ∏è Ville</button>
                <button class="btn secondary" onclick="manageBuildings()">üèóÔ∏è B√¢timents</button>
                <button class="btn secondary" onclick="recruitUnits()">‚öîÔ∏è Recruter</button>
            </div>

            <div class="control-panel">
                <h3>‚öîÔ∏è Combat & Actions</h3>
                <button class="btn" onclick="startCombat()">‚öîÔ∏è Combat</button>
                <button class="btn secondary" onclick="moveHero()">üö∂ D√©placer</button>
                <button class="btn secondary" onclick="castSpell()">‚ú® Magie</button>
            </div>

            <div class="control-panel">
                <h3>üë§ H√©ros & Objets</h3>
                <button class="btn" onclick="openHero()">üë§ H√©ros</button>
                <button class="btn secondary" onclick="inventory()">üéí Inventaire</button>
                <button class="btn secondary" onclick="magicJoint()">üö¨ Joint Magique</button>
            </div>
        </div>

        <!-- Causal Engine Controls -->
        <div class="control-panel">
            <h3>üåÄ Moteur Causal - Tests & Simulations</h3>
            
            <div class="input-group">
                <label for="axisiPower">Puissance AXISI:</label>
                <input type="number" id="axisiPower" value="3.14" step="0.01" min="0" max="10">
            </div>
            
            <div class="input-group">
                <label for="lentusPower">Puissance LENTUS:</label>
                <input type="number" id="lentusPower" value="2.71" step="0.01" min="0" max="10">
            </div>
            
            <div class="input-group">
                <label for="scenario">Sc√©nario:</label>
                <select id="scenario">
                    <option value="axisi_vs_lentus_battle">AXISI vs LENTUS Battle</option>
                    <option value="temporal_laboratory">Laboratoire Temporel</option>
                    <option value="zone_inverted_001">Zone Invers√©e 001</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="turns">Nombre de Tours:</label>
                <input type="number" id="turns" value="10" min="1" max="100">
            </div>
            
            <button class="btn" onclick="runCrossInteraction()">üîÑ Cross-Interaction</button>
            <button class="btn" onclick="runTemporalSimulation()">‚è∞ Simulation Temporelle</button>
            <button class="btn secondary" onclick="testAllFormulas()">üß™ Test Complet</button>
        </div>

        <!-- Status Display -->
        <div class="status-display">
            <h3>üìä √âtat du Syst√®me</h3>
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-value" id="paradoxRisk">0.00</span>
                    <div class="status-label">Paradox Risk</div>
                </div>
                <div class="status-item">
                    <span class="status-value" id="temporalStability">1.00</span>
                    <div class="status-label">Temporal Stability</div>
                </div>
                <div class="status-item">
                    <span class="status-value" id="affectedRadius">0.00</span>
                    <div class="status-label">Affected Radius</div>
                </div>
                <div class="status-item">
                    <span class="status-value" id="causalWeight">0.00</span>
                    <div class="status-label">Causal Weight</div>
                </div>
            </div>
        </div>

        <!-- Game Area -->
        <div class="game-area">
            <h3>üó∫Ô∏è Zone de Jeu</h3>
            <p>Interface de jeu sera rendue ici...</p>
            <div id="gameCanvas" style="width: 100%; height: 300px; background: rgba(0,0,0,0.3); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: #a0a0a0;">
                üéÆ Cliquez sur "New Game" pour commencer
            </div>
        </div>

        <!-- Log Area -->
        <div class="control-panel">
            <h3>üìù Journal des Actions</h3>
            <div class="log-area" id="logArea">
                <div class="log-entry info">üöÄ Interface Temporelle Engine initialis√©e</div>
                <div class="log-entry info">üîó Connexion au backend en cours...</div>
            </div>
            <button class="btn secondary" onclick="clearLogs()">üóëÔ∏è Effacer Logs</button>
        </div>
    </div>

    <div class="footer">
        <p>üåü Heroes of Time - Temporal Engine Interface</p>
        <p>Backend API: <span id="apiUrl">http://localhost:8080</span> | Frontend: Port 8000</p>
        <p>Jean-Grofignon Engine ¬© 2025 - Documentation API Compl√®te</p>
    </div>

    <script>
        // Configuration API
        const API_BASE = 'http://localhost:8080/api';
        
        // √âtat global
        let gameState = {
            gameId: null,
            currentPlayer: null,
            turn: 1,
            backendOnline: false,
            causalEngineOnline: false
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            checkBackendHealth();
            setInterval(checkBackendHealth, 30000); // Check every 30 seconds
            log('üéÆ Interface Temporelle Engine charg√©e', 'success');
        });

        // === FONCTIONS API ===

        async function checkBackendHealth() {
            try {
                const response = await fetch(`${API_BASE}/causal/health`);
                const data = await response.json();
                
                if (data.status === 'UP') {
                    updateAPIStatus('backend', true);
                    updateAPIStatus('causal', true);
                    gameState.backendOnline = true;
                    gameState.causalEngineOnline = true;
                    log('‚úÖ Backend op√©rationnel - ' + data.service + ' v' + data.version, 'success');
                } else {
                    throw new Error('Backend not ready');
                }
            } catch (error) {
                updateAPIStatus('backend', false);
                updateAPIStatus('causal', false);
                gameState.backendOnline = false;
                gameState.causalEngineOnline = false;
                log('‚ùå Backend indisponible: ' + error.message, 'error');
            }
        }

        async function runCrossInteraction() {
            if (!gameState.causalEngineOnline) {
                log('‚ùå Moteur causal indisponible', 'error');
                return;
            }

            const axisiPower = parseFloat(document.getElementById('axisiPower').value);
            const lentusPower = parseFloat(document.getElementById('lentusPower').value);
            
            log(`üîÑ Test Cross-Interaction: AXISI=${axisiPower}, LENTUS=${lentusPower}`, 'info');
            
            try {
                const response = await fetch(`${API_BASE}/causal/cross-interaction`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        axisiPower: axisiPower,
                        lentusPower: lentusPower,
                        interactionType: 'BATTLE'
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                // Mettre √† jour les m√©triques
                updateMetrics(data);
                
                log(`‚úÖ Cross-Interaction r√©ussie - Effect: ${data.effect}`, 'success');
                log(`üìä Paradox Risk: ${data.paradoxRisk}, Stability: ${data.temporalStability}`, 'info');
                
            } catch (error) {
                log('‚ùå Erreur Cross-Interaction: ' + error.message, 'error');
            }
        }

        async function runTemporalSimulation() {
            if (!gameState.causalEngineOnline) {
                log('‚ùå Moteur causal indisponible', 'error');
                return;
            }

            const scenario = document.getElementById('scenario').value;
            const turns = parseInt(document.getElementById('turns').value);
            
            log(`‚è∞ Simulation Temporelle: ${scenario} - ${turns} tours`, 'info');
            
            try {
                const response = await fetch(`${API_BASE}/causal/temporal-simulation`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        scenario: scenario,
                        turns: turns,
                        sessionId: 'frontend-session-' + Date.now()
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                log(`‚úÖ Simulation compl√©t√©e - ${data.totalTurns} tours`, 'success');
                
                // Afficher r√©sultats des derniers tours
                const lastTurns = data.turnResults.slice(-3);
                lastTurns.forEach(turn => {
                    log(`üìà Tour ${turn.turn}: AXISI=${turn.axisiPower}, Balance=${turn.causalBalance}, Event=${turn.event}`, 'info');
                });
                
            } catch (error) {
                log('‚ùå Erreur Simulation: ' + error.message, 'error');
            }
        }

        async function testAllFormulas() {
            log('üß™ Test complet des formules causales...', 'info');
            
            // Test s√©quentiel des diff√©rentes formules
            await runCrossInteraction();
            await new Promise(resolve => setTimeout(resolve, 1000));
            await runTemporalSimulation();
            
            log('‚úÖ Test complet termin√©', 'success');
        }

        // === FONCTIONS DE JEU ===

        async function newGame() {
            log('üéÆ Cr√©ation d\'un nouveau jeu...', 'info');
            
            try {
                const response = await fetch(`${API_BASE}/games`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        playerCount: 2,
                        gameMode: 'conquest-classic',
                        mapSize: 'medium'
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                gameState.gameId = data.id;
                
                document.getElementById('gameCanvas').innerHTML = 
                    `üó∫Ô∏è Jeu cr√©√©: ${data.id}<br/>üë• Joueurs: ${data.players?.length || 2}<br/>üéØ Mode: ${data.gameMode || 'conquest'}`;
                
                log(`‚úÖ Jeu cr√©√© avec succ√®s: ${data.id}`, 'success');
                
            } catch (error) {
                log('‚ùå Erreur cr√©ation jeu: ' + error.message, 'error');
            }
        }

        function loadGame() {
            log('üìÇ Chargement d\'un jeu...', 'info');
            // Impl√©mentation future
        }

        function saveGame() {
            if (!gameState.gameId) {
                log('‚ùå Aucun jeu √† sauvegarder', 'error');
                return;
            }
            log('üíæ Sauvegarde du jeu...', 'info');
            // Impl√©mentation future
        }

        function openTown() {
            log('üèõÔ∏è Ouverture de la ville...', 'info');
            // Impl√©mentation future
        }

        function manageBuildings() {
            log('üèóÔ∏è Gestion des b√¢timents...', 'info');
            // Impl√©mentation future
        }

        function recruitUnits() {
            log('‚öîÔ∏è Recrutement d\'unit√©s...', 'info');
            // Impl√©mentation future
        }

        function startCombat() {
            log('‚öîÔ∏è D√©but du combat...', 'info');
            // Impl√©mentation future
        }

        function moveHero() {
            log('üö∂ D√©placement du h√©ros...', 'info');
            // Impl√©mentation future
        }

        function castSpell() {
            log('‚ú® Lancement de sort...', 'info');
            // Impl√©mentation future
        }

        function openHero() {
            log('üë§ Ouverture fiche h√©ros...', 'info');
            // Impl√©mentation future
        }

        function inventory() {
            log('üéí Ouverture inventaire...', 'info');
            // Impl√©mentation future
        }

        function magicJoint() {
            log('üö¨ Utilisation du Joint Magique...', 'info');
            // Effet sp√©cial Jean-Grofignon
            const effects = [
                '‚ú® R√©v√©lation cosmique!',
                'üåÄ Perception temporelle augment√©e!',
                'üß† Connexion avec la Grofi-Pens√©e!',
                'üåü √âtat de conscience √©largi!',
                'üîÆ Vision des possibilit√©s quantiques!'
            ];
            const randomEffect = effects[Math.floor(Math.random() * effects.length)];
            log('üö¨ Joint Magique activ√©: ' + randomEffect, 'success');
        }

        // === FONCTIONS UTILITAIRES ===

        function updateAPIStatus(type, online) {
            const dot = document.getElementById(type + 'Dot');
            const status = document.getElementById(type + 'Status');
            
            if (online) {
                dot.className = 'api-dot online';
                status.textContent = 'Online';
            } else {
                dot.className = 'api-dot offline';
                status.textContent = 'Offline';
            }
        }

        function updateMetrics(data) {
            if (data.paradoxRisk !== undefined) {
                document.getElementById('paradoxRisk').textContent = data.paradoxRisk;
            }
            if (data.temporalStability !== undefined) {
                document.getElementById('temporalStability').textContent = data.temporalStability;
            }
            if (data.affectedRadius !== undefined) {
                document.getElementById('affectedRadius').textContent = data.affectedRadius;
            }
            if (data.causalWeight !== undefined) {
                document.getElementById('causalWeight').textContent = data.causalWeight;
            }
        }

        function log(message, type = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
            
            // Limiter √† 50 entr√©es
            const entries = logArea.children;
            if (entries.length > 50) {
                logArea.removeChild(entries[0]);
            }
        }

        function clearLogs() {
            document.getElementById('logArea').innerHTML = '';
            log('üóëÔ∏è Logs effac√©s', 'info');
        }
    </script>
</body>
</html> 