<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heroes of Time - Temporal Engine</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="temporal-styles.css">
    <link rel="stylesheet" href="translation-styles.css">
    <link rel="stylesheet" href="styles/city.css">
    <link rel="stylesheet" href="styles/combat.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="title">🕰️ Heroes of Time - Temporal Engine</div>
            <div class="controls">
                <button id="new-game-btn" class="btn-primary">🎮 New Game</button>
                <button id="city-btn" class="btn-primary">🏛️ Ville</button>
                <button id="combat-btn" class="btn-primary">⚔️ Combat</button>
                <button id="add-ragnar-btn" class="btn-secondary">🛡️ Add Ragnar</button>
                <button id="test-decay-btn" class="btn-warning">⏰ Test Decay</button>
                <button id="settings-btn" class="btn-icon">⚙️</button>
            </div>
        </header>
        
        <div class="game-area">
            <div class="game-board">
                <canvas id="game-canvas"></canvas>
                <div class="game-overlay">
                    <div class="temporal-info" id="temporal-info">
                        <div class="info-card">
                            <h3>⏰ Temporal Status</h3>
                            <div id="current-timeline">Timeline: ℬ1</div>
                            <div id="current-turn">Turn: 0</div>
                            <div id="decay-status">Decay: None</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="side-panel">
                <!-- 🌫️ Brouillard de Causalité -->
                <div id="fog-controls-container"></div>
                
                <!-- 🎮 Contrôles Principaux -->
                <div class="main-controls">
                    <div class="control-section">
                        <h3>🎮 Contrôles Principaux</h3>
                        <div class="control-buttons">
                            <button id="hero-select-btn" class="btn-control">👁️ Sélectionner Héros</button>
                            <button id="move-btn" class="btn-control">🚶 Déplacer</button>
                            <button id="attack-btn" class="btn-control">⚔️ Attaquer</button>
                            <button id="explore-btn" class="btn-control">🗺️ Explorer</button>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <h3>🔮 Actions Temporelles</h3>
                        <div class="control-buttons">
                            <button id="psi-create-btn" class="btn-control">ψ Créer État</button>
                            <button id="psi-collapse-btn" class="btn-control">† Effondrer</button>
                            <button id="timeline-switch-btn" class="btn-control">🔄 Changer Timeline</button>
                        </div>
                    </div>
                </div>
                
                <div class="script-console" id="script-console">
                    <!-- Console will be populated by JavaScript -->
                </div>
                
                <div class="hero-panel" id="hero-panel">
                    <h3>🦸 Heroes</h3>
                    <div id="heroes-list"></div>
                </div>
                
                <div class="psi-panel" id="psi-panel">
                    <h3>🔮 États ψ</h3>
                    <div id="psi-states-list"></div>
                </div>
                
                <div class="decay-panel" id="decay-panel">
                    <h3>🎭 Anna's Decay System</h3>
                    <div class="decay-controls">
                        <button id="apply-decay-btn" class="btn-warning">Apply Decay</button>
                        <button id="repair-buildings-btn" class="btn-success">Repair Buildings</button>
                    </div>
                    <div id="decay-stats"></div>
                </div>
            </div>
        </div>
        
        <div class="status-bar" id="status-bar">
            Ready to start... Anna the Martopicker watches from the shadows ⏰
        </div>
        
        <!-- 🎮 Bouton d'ouverture du sélecteur de scénarios -->
        <button id="open-scenario-selector-btn" class="scenario-selector-btn">
            🎮 Scénarios
        </button>
    </div>
    
    <script src="api.js"></script>
    <script src="translation-service.js"></script>
    <script src="components/CityInterface.js"></script>
    <script src="components/CombatInterface.js"></script>
    <script src="script-console.js"></script>
    <script src="game.js"></script>
    <script src="runic-forge.js"></script>
    <script src="temporal-integration.js"></script>
    <script src="hero-avatars.js"></script>
    <script src="scenario-selector.js"></script>
    <script src="gameplay-enhancement.js"></script>
    <script src="missing-assets-loader.js"></script>
    <script src="gameplay-construction.js"></script>
    <script src="fog-of-war-system.js"></script>
    <script>
        // Initialisation de l'application
        window.gameAPI = new GameAPI();
        window.gameRenderer = new GameRenderer('game-canvas');
        window.scriptConsole = new ScriptConsole('script-console');
        window.temporalIntegration = new TemporalIntegration();
        window.gameplayEnhancement = new GameplayEnhancement();
        window.missingAssetsLoader = new MissingAssetsLoader();
        window.gameplayConstruction = new GameplayConstruction();
        
        // 🌫️ Initialiser le système de brouillard de causalité
        window.fogOfWarSystem = new FogOfWarSystem();
        const fogControlsContainer = document.getElementById('fog-controls-container');
        if (fogControlsContainer) {
            fogControlsContainer.appendChild(window.fogOfWarSystem.createFogControls());
        }
        
        // 🏛️ Événements pour l'interface de ville
        document.getElementById('city-btn').addEventListener('click', () => {
            window.cityInterface.toggle();
        });
        
        // ⚔️ Événements pour l'interface de combat
        document.getElementById('combat-btn').addEventListener('click', () => {
            window.combatInterface.toggle();
        });
        
        // 🌐 Initialiser le service de traduction
        window.translationService = new TranslationService();
        
        // 🏛️ Initialiser l'interface de ville
        window.cityInterface = new CityInterface();
        
        // ⚔️ Initialiser l'interface de combat
        window.combatInterface = new CombatInterface();
        
        // 🎮 Initialiser le sélecteur de scénarios
        window.scenarioSelector = new ScenarioSelector();
        const openScenarioBtn = document.getElementById('open-scenario-selector-btn');
        if (openScenarioBtn) {
            openScenarioBtn.addEventListener('click', () => {
                const selectorInterface = window.scenarioSelector.createSelectorInterface();
                document.body.appendChild(selectorInterface);
            });
        }
        
        // Fonction pour mettre à jour la barre de statut
        window.updateStatusBar = function(message) {
            const statusBar = document.getElementById('status-bar');
            if (statusBar) {
                statusBar.textContent = message;
            }
        };
        
        // Initialisation au chargement
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎮 Heroes of Time - Interface principale chargée');
            window.updateStatusBar('Interface prête - Cliquez "New Game" pour commencer');
        });
    </script>
</body>
</html>