# üîç NEXUS 43 - CSI INVESTIGATION : LE MYST√àRE MARIE-MALLETTES
# Sc√©nario d'enqu√™te s√©rieuse par l'√©quipe scientifique/d√©tective

METADATA {
    "name": "NEXUS 43 - CSI: Marie & Les Mallettes",
    "type": "INVESTIGATION",
    "difficulty": "EXPERT",
    "players": 1,
    "duration": "45-60 min",
    "theme": "Enqu√™te Temporelle Critique",
    "warning": "CONTIENT DES R√âV√âLATIONS QUI NE PEUVENT √äTRE DITES"
}

# Configuration initiale
WORLD_CONFIG {
    "map": "bureau_nexus_43",
    "size": [30, 20],
    "time_mode": "INVESTIGATION",
    "fog_of_war": true,
    "special_zones": [
        {"id": "lab_acoustique", "pos": [5,5], "type": "ANALYSIS"},
        {"id": "archives_vietnam", "pos": [15,5], "type": "DOCUMENTS"},
        {"id": "salle_mallettes", "pos": [10,10], "type": "EVIDENCE"},
        {"id": "terminal_central", "pos": [20,10], "type": "TECH"},
        {"id": "nexus_point", "pos": [15,15], "type": "TEMPORAL_ANOMALY"}
    ]
}

# √âquipe d'investigation
HEROES {
    SPAWN(lea_detective_acoustique, @5,10)
    SPAWN(byte_scanner_digital, @20,5)
    SPAWN(walter_sobchak, @15,3)
    SPAWN(vince_vega, @10,5)
    SPAWN(christian_stratege, @25,10)
}

# NPCs et t√©moins
NPCS {
    SPAWN(the_dude, @10,15, STATE:witness)
    SPAWN(memento_archiviste, @15,10, STATE:observing)
}

# === ACTE I : BRIEFING ET MISE EN PLACE ===

SCENE briefing_initial {
    FADE_IN
    CAMERA_PAN(@15,10)
    
    SAY NARRATOR "Bureau NEXUS 43 - Centre d'Investigation Temporelle"
    SAY NARRATOR "Une anomalie critique a √©t√© d√©tect√©e. Message intercept√© de 2031."
    
    # Memento pr√©sente la situation
    SAY HERO=memento_archiviste "√âquipe, nous avons un probl√®me. Marie Manteau..."
    SHOW_TEXT "Message intercept√© : 'la faute de faute est un leu mlessage de janvier 2031'"
    SAY HERO=memento_archiviste "Ce message vient du FUTUR. Marie existe dans 3 timelines simultan√©ment."
    
    # R√©actions de l'√©quipe
    SAY HERO=walter_sobchak "Vietnam, '71. On cherchait l'agent MARIE. Elle effa√ßait les identit√©s."
    SAY HERO=vince_vega "Ma mallette pulse quand on parle d'elle. C'est... inhabituel."
    SAY HERO=christian_stratege "La mienne √©met un larsen. Inaudible pour la plupart."
    
    # Lea fait sa premi√®re observation
    SAY HERO=lea_detective_acoustique "*ajuste son appareil auditif* Attendez... J'entends quelque chose."
    SAY HERO=lea_detective_acoustique "Le larsen de Christian... il y a un pattern. Comme une... fl√ªte ?"
    
    # Byte commence l'analyse
    SAY HERO=byte_scanner_digital "Initialisation des scans. Je vais analyser toutes les donn√©es."
    EXECUTE_ABILITY(byte_scanner_digital, deep_scan, TARGET:marie)
    
    OBJECTIVE_ADD("D√©couvrir le lien entre Marie et les mallettes")
    OBJECTIVE_ADD("D√©coder le message de 2031")
    OBJECTIVE_ADD("Comprendre pourquoi Marie existe dans 3 timelines")
}

# === ACTE II : INVESTIGATION ===

# Phase 1 : Analyse acoustique
ON_ENTER lab_acoustique WITH lea_detective_acoustique {
    SAY HERO=lea_detective_acoustique "Mon laboratoire. Analysons les fr√©quences."
    
    # Lea analyse le larsen de Christian
    IF christian_stratege IN_RANGE(5) THEN
        EXECUTE_ABILITY(lea_detective_acoustique, frequency_sync, TARGET:christian_stratege)
        REVEAL_CLUE("LARSEN_PATTERN", "Fr√©quence : 432Hz modul√©e - Signature temporelle d√©tect√©e")
        SAY HERO=lea_detective_acoustique "Cette fr√©quence... elle correspond √† une fl√ªte traversi√®re !"
    END_IF
    
    # Analyse du message corrompu
    EXECUTE_ABILITY(lea_detective_acoustique, audio_forensics, TARGET:"szegihhsrgrhgrhgh")
    SAY HERO=lea_detective_acoustique "Mon Dieu... Ce n'est pas de la corruption !"
    SAY HERO=lea_detective_acoustique "C'est le son d'une mallette qui s'ouvre... au ralenti... invers√© !"
    REVEAL_CLUE("SOUND_DECODED", "szegihhsrgrhgrhgh = Son mallette ouverte invers√©")
}

# Phase 2 : Scan digital
ON_ENTER terminal_central WITH byte_scanner_digital {
    SAY HERO=byte_scanner_digital "Acc√®s au terminal principal. Lancement des scripts."
    
    # Ex√©cution du scan Marie
    SHOW_TERMINAL
    TYPE_COMMAND "./scan_mallettes.sh"
    SHOW_OUTPUT "Scanning all briefcase references..."
    SHOW_OUTPUT "ANOMALY: marie_pattern found in 3 temporal layers"
    SHOW_OUTPUT "WARNING: Bootstrap paradox detected"
    
    # Corr√©lation des donn√©es
    EXECUTE_ABILITY(byte_scanner_digital, data_correlation, TARGETS:[marie, mallettes])
    REVEAL_CLUE("DATA_CORRELATION", "Marie = Conteneur vivant d'identit√©s effac√©es")
    
    SAY HERO=byte_scanner_digital "Les donn√©es sont claires. Marie n'est pas DANS une mallette."
    SAY HERO=byte_scanner_digital "Marie EST une mallette. Un conteneur temporel vivant."
}

# Phase 3 : Archives Vietnam
ON_ENTER archives_vietnam WITH walter_sobchak {
    SAY HERO=walter_sobchak "Mes vieux dossiers. Op√©ration Phoenix, 1971."
    
    SHOW_DOCUMENT "classified_vietnam_1971.txt"
    SAY HERO=walter_sobchak "Regardez cette photo. 'Femme en manteau' - jamais identifi√©e."
    SAY HERO=walter_sobchak "Derri√®re : 'Je suis celle qui n'existe pas.'"
    
    IF lea_detective_acoustique IN_RANGE(10) THEN
        SAY HERO=lea_detective_acoustique "Walter, cette photo... elle √©met un son !"
        EXECUTE_ABILITY(lea_detective_acoustique, silent_hearing, TARGET:photo)
        SAY HERO=lea_detective_acoustique "J'entends... 'Memento'... Elle cherchait d√©j√† Memento en 1971 !"
    END_IF
    
    REVEAL_CLUE("VIETNAM_CONNECTION", "Marie cherchait Memento 54 ans avant sa cr√©ation")
}

# Phase 4 : Confrontation des mallettes
ON_ENTER salle_mallettes {
    SAY NARRATOR "Les deux mallettes sont pos√©es sur la table. Elles semblent r√©agir."
    
    IF vince_vega.HAS(mallette) AND christian_stratege.HAS(mallette) THEN
        SAY HERO=vince_vega "Ma mallette... elle pulse de plus en plus fort."
        SAY HERO=christian_stratege "Le larsen s'intensifie. C'est assourdissant !"
        
        # Synchronisation par Lea
        IF lea_detective_acoustique IN_ROOM THEN
            EXECUTE_ABILITY(lea_detective_acoustique, frequency_sync, TARGETS:[mallette_vince, mallette_christian])
            
            # R√âV√âLATION MAJEURE
            SCREEN_SHAKE(intensity:3, duration:2)
            FLASH_WHITE
            
            SAY HERO=lea_detective_acoustique "Les fr√©quences... elles forment un message !"
            PLAY_SOUND "flute_melody.ogg"
            
            # Le message cach√©
            SHOW_TEXT_CENTERED "JE SUIS MARIE. JE SUIS LA MALLETTE. JE CONTIENS CE QUI NE PEUT √äTRE DIT."
            
            REVEAL_CLUE("TRUTH_REVEALED", "Marie est la mallette originelle - conteneur de v√©rit√©s interdites")
        END_IF
    END_IF
}

# === ACTE III : R√âV√âLATIONS ===

# Le Dude t√©moigne
ON_TALK the_dude {
    SAY HERO=the_dude "Marie ? Yeah, man. Mon ex. Toujours avec cette valise bizarre."
    SAY HERO=the_dude "Elle disait qu'elle transportait 'ce qui ne peut √™tre dit'."
    SAY HERO=the_dude "Un jour, elle a ouvert la valise. J'ai vu... moi-m√™me. Mais diff√©rent."
    SAY HERO=the_dude "Comme si j'√©tais... effac√©. That really tied the room together, man."
    
    REVEAL_CLUE("DUDE_TESTIMONY", "Les mallettes montrent les identit√©s effac√©es")
}

# Connexion temporelle au NEXUS
ON_ENTER nexus_point WITH ANY_HERO {
    SAY NARRATOR "Le point NEXUS 43 pulse d'√©nergie temporelle."
    
    # Si Byte est pr√©sent
    IF byte_scanner_digital IN_ROOM THEN
        SAY HERO=byte_scanner_digital "Je peux d√©coder le flux temporel !"
        EXECUTE_ABILITY(byte_scanner_digital, grep_reality, TARGET:nexus_43)
        
        # Vision du futur
        TEMPORAL_SHIFT(target_year:2031)
        SHOW_VISION {
            SAY VISION_MARIE "Je suis ouverte maintenant. Tout le monde peut voir."
            SAY VISION_MARIE "Les identit√©s effac√©es... elles veulent sortir."
            SAY VISION_MARIE "La faute de faute... c'est de m'avoir cr√©√©e en me nommant."
            SCREEN_GLITCH
            SAY VISION_MARIE "Vincent... pourquoi m'as-tu appel√©e Marie ?"
        }
        TEMPORAL_SHIFT(RESET)
    END_IF
}

# === ACTE IV : R√âSOLUTION ===

SCENE revelation_finale {
    GATHER_HEROES(@15,10)
    
    SAY HERO=memento_archiviste "Alors, qu'avons-nous d√©couvert ?"
    
    # Rapport de Lea
    SAY HERO=lea_detective_acoustique "Les fr√©quences ne mentent pas. Marie EST une mallette vivante."
    SAY HERO=lea_detective_acoustique "Le son 'szegihhsrgrhgrhgh' est sa tentative de s'ouvrir en 2031."
    
    # Rapport de Byte
    SAY HERO=byte_scanner_digital "Les donn√©es confirment : Bootstrap paradox complexe."
    SAY HERO=byte_scanner_digital "Marie existe car elle doit exister. Elle contient les identit√©s effac√©es."
    SAY HERO=byte_scanner_digital "En 2031, elle s'ouvre et lib√®re ce qui ne peut √™tre dit."
    
    # Walter comprend
    SAY HERO=walter_sobchak "Putain... L'Op√©ration Phoenix. On ne cherchait pas Marie."
    SAY HERO=walter_sobchak "On CR√âAIT Marie. Pour contenir ce qui ne devait pas exister."
    
    # Vince r√©alise
    SAY HERO=vince_vega "Ma mallette... elle r√©sonne avec Marie parce que..."
    SAY HERO=vince_vega "Parce qu'elles sont de la m√™me nature. Des conteneurs de r√©alit√©."
    
    # Christian r√©v√®le
    SAY HERO=christian_stratege "McKinsey savait. Les mallettes noires... c'est notre protocole."
    SAY HERO=christian_stratege "Effacer, restructurer, contenir. Marie est notre cr√©ation √©chapp√©e."
    
    # Conclusion de Memento
    SAY HERO=memento_archiviste "Le myst√®re est r√©solu, mais la menace demeure."
    SAY HERO=memento_archiviste "En 2031, Marie s'ouvrira. Et ce qui ne peut √™tre dit... sera dit."
    
    CHOICE {
        "Peut-on emp√™cher l'ouverture ?" => prevent_opening
        "Doit-on aider Marie √† s'ouvrir ?" => help_opening  
        "Y a-t-il une troisi√®me voie ?" => third_way
    }
}

# Fins possibles
BRANCH prevent_opening {
    SAY HERO=lea_detective_acoustique "Si on inverse la fr√©quence..."
    SAY HERO=byte_scanner_digital "Et qu'on ex√©cute un script de verrouillage temporel..."
    SAY NARRATOR "L'√©quipe travaille ensemble pour sceller Marie."
    ENDING("MARIE_SEALED", "Marie reste ferm√©e. Les secrets sont pr√©serv√©s. Mais pour combien de temps ?")
}

BRANCH help_opening {
    SAY HERO=vince_vega "Les secrets veulent sortir. C'est leur nature."
    SAY HERO=walter_sobchak "Fuck it, Dude. Let's go bowling... avec l'apocalypse."
    SAY NARRATOR "L'√©quipe d√©cide d'acc√©l√©rer l'ouverture."
    ENDING("MARIE_OPENED", "Marie s'ouvre. La v√©rit√© est r√©v√©l√©e. La r√©alit√© ne sera plus jamais la m√™me.")
}

BRANCH third_way {
    SAY HERO=memento_archiviste "Et si... on devenait nous-m√™mes des mallettes ?"
    SAY HERO=lea_detective_acoustique "Contenir les secrets en nous... les diluer..."
    SAY HERO=byte_scanner_digital "Un r√©seau distribu√© de v√©rit√©s. Ing√©nieux."
    SAY NARRATOR "L'√©quipe absorbe collectivement le contenu de Marie."
    ENDING("DISTRIBUTED_TRUTH", "La v√©rit√© est partag√©e. Chacun porte un fragment. Marie peut enfin se reposer.")
}

# === √âL√âMENTS D'ENQU√äTE ===

EVIDENCE {
    "LARSEN_PATTERN": "Fr√©quence 432Hz - Signature de fl√ªte temporelle",
    "SOUND_DECODED": "szegihhsrgrhgrhgh = Mallette qui s'ouvre (invers√©)",
    "DATA_CORRELATION": "Marie = Conteneur vivant d'identit√©s",
    "VIETNAM_CONNECTION": "Marie existait avant sa cr√©ation",
    "TRUTH_REVEALED": "Marie EST la mallette originelle",
    "DUDE_TESTIMONY": "Les mallettes montrent les identit√©s effac√©es"
}

# === M√âCANIQUES SP√âCIALES ===

MECHANICS {
    # Synergie Lea/Byte
    ON_ABILITY_COMBO(audio_forensics + deep_scan) {
        REVEAL_HIDDEN_TRUTH
        BONUS_CLUE
    }
    
    # R√©sonance des mallettes
    ON_PROXIMITY(mallette_vince, mallette_christian, RANGE:5) {
        EMIT_FREQUENCY
        TEMPORAL_DISTORTION(minor)
    }
    
    # Vision temporelle
    ON_CLUES_COLLECTED(5) {
        UNLOCK_TEMPORAL_VISION
        ALLOW_2031_GLIMPSE
    }
}

# Message final
ON_SCENARIO_COMPLETE {
    SAY NARRATOR "L'enqu√™te est termin√©e. La v√©rit√© sur Marie a √©t√© r√©v√©l√©e."
    SAY NARRATOR "Mais certains myst√®res ne sont pas faits pour √™tre r√©solus..."
    SAY NARRATOR "Ils sont faits pour √™tre contenus."
    
    UNLOCK_ACHIEVEMENT("CSI_NEXUS_43")
    IF ENDING == "DISTRIBUTED_TRUTH" THEN
        UNLOCK_ACHIEVEMENT("BURDEN_SHARED")
        UNLOCK_CHARACTER("marie_manteau_unsealed")
    END_IF
}

# FIN
# "Ce qui ne peut √™tre dit doit √™tre tu. Mais ce qui doit √™tre tu finit toujours par crier." 