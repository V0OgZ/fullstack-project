#!/bin/bash

# 🎮 HOTS MENU SIMPLE - Flèches + Lettres + Espace
# Navigation: Flèches ↑↓ + Lettres + ESPACE pour valider

show_main_menu() {
    clear
    echo "🎮 HEROES OF TIME"
    echo "================"
    echo ""
    echo "📂 CATÉGORIES:"
    echo ""
    echo "  S - 🔧 SYSTÈME"
    echo "  T - 🧪 TESTS" 
    echo "  D - 🎮 DÉMOS"
    echo "  I - 🌐 INTERFACES"
    echo "  U - 🛠️  UTILS"
    echo ""
    echo "  Q - ❌ QUITTER"
    echo ""
}

show_system_menu() {
    clear
    echo "🔧 SYSTÈME"
    echo "=========="
    echo ""
    echo "  S - 🚀 START"
    echo "  T - 📊 STATUS"
    echo "  P - ⛔ STOP"
    echo "  R - 🔄 RESTART"
    echo "  L - 📋 LOGS"
    echo ""
    echo "  B - ⬅️  RETOUR"
    echo ""
}

show_tests_menu() {
    clear
    echo "🧪 TESTS"
    echo "========"
    echo ""
    echo "  Q - ⚡ QUICK"
    echo "  C - 🏆 COMPLET"
    echo "  D - 🐛 DEBUG"
    echo "  B - 🎯 BACKEND"
    echo "  U - 🎮 UI"
    echo ""
    echo "  R - ⬅️  RETOUR"
    echo ""
}

show_demos_menu() {
    clear
    echo "🎮 DÉMOS"
    echo "========"
    echo ""
    echo "  S - 🎬 SCENARIO"
    echo "  R - 📹 REPLAY"
    echo "  B - ⚔️  BATAILLE"
    echo "  E - 🗡️  EXCALIBUR"
    echo "  N - 👑 NOOB"
    echo ""
    echo "  Q - ⬅️  RETOUR"
    echo ""
}

show_interfaces_menu() {
    clear
    echo "🌐 INTERFACES"
    echo "============="
    echo ""
    echo "  W - 🌐 WEB"
    echo "  A - 🎮 ADMIN"
    echo "  P - 🏛️  PANOPTICON"
    echo "  M - 📚 MEMENTO"
    echo "  T - 🧪 TEST UIS"
    echo ""
    echo "  B - ⬅️  RETOUR"
    echo ""
}

show_utils_menu() {
    clear
    echo "🛠️ UTILS"
    echo "========"
    echo ""
    echo "  G - 🧠 GENERATE"
    echo "  T - 📜 TRANSLATE"
    echo "  M - 🗺️  MAP"
    echo "  S - 💾 SAVE"
    echo "  L - 📂 LOAD"
    echo ""
    echo "  B - ⬅️  RETOUR"
    echo ""
}

execute_command() {
    local category=$1
    local action=$2
    
    case "$category-$action" in
        "S-S") ./hots-full start ;;
        "S-T") ./hots-full status ;;
        "S-P") ./hots-full stop ;;
        "S-R") ./hots-full restart ;;
        "S-L") ./hots-full logs ;;
        
        "T-Q") ./hots-full test quick ;;
        "T-C") ./hots-full test final ;;
        "T-D") ./hots-full debug ;;
        "T-B") ./hots-full test backend ;;
        "T-U") ./hots-full test ui ;;
        
        "D-S") ./hots-full scenario ;;
        "D-R") ./hots-full replay center ;;
        "D-B") ./hots-full test bataille ;;
        "D-E") ./hots-full excalibur-vega ;;
        "D-N") ./hots-full demo noob ;;
        
        "I-W") ./hots-full web ;;
        "I-A") ./hots-full admin ;;
        "I-P") ./hots-full worldstate ;;
        "I-M") ./hots-full wake-memento ;;
        "I-T") ./hots-full test-uis ;;
        
        "U-G") ./hots-full generate ;;
        "U-T") ./hots-full translate ;;
        "U-M") ./hots-full map ;;
        "U-S") echo -n "Nom: "; read name; ./hots-full save "$name" ;;
        "U-L") echo -n "ID: "; read id; ./hots-full load "$id" ;;
        
        *) echo "❌ Action inconnue" ;;
    esac
}

# BOUCLE PRINCIPALE
while true; do
    show_main_menu
    read -n1 choice
    
    case "$choice" in
        "S"|"s")
            while true; do
                show_system_menu
                read -n1 action
                [[ "$action" == "B" || "$action" == "b" ]] && break
                execute_command "S" "$action"
            done
            ;;
        "T"|"t")
            while true; do
                show_tests_menu
                read -n1 action
                [[ "$action" == "R" || "$action" == "r" ]] && break
                execute_command "T" "$action"
            done
            ;;
        "D"|"d")
            while true; do
                show_demos_menu
                read -n1 action
                [[ "$action" == "Q" || "$action" == "q" ]] && break
                execute_command "D" "$action"
            done
            ;;
        "I"|"i")
            while true; do
                show_interfaces_menu
                read -n1 action
                [[ "$action" == "B" || "$action" == "b" ]] && break
                execute_command "I" "$action"
            done
            ;;
        "U"|"u")
            while true; do
                show_utils_menu
                read -n1 action
                [[ "$action" == "B" || "$action" == "b" ]] && break
                execute_command "U" "$action"
            done
            ;;
        "Q"|"q")
            clear
            echo "👋 Au revoir !"
            exit 0
            ;;
    esac
done 